---
title: Go实战：redis分布式锁开发问题
date: 2023-09-25 17:30:28
categories:
- 八股文
tags:
- redis
- 分布式锁
---

之前金山面试被问到了怎么实现Redis分布式锁，但是答了个大概，但是再往深的问，就有些不会了。因此查了查相关博客，大概了解了整个过程。试着用一个redis + gin的小demo实战一下各种情况


## SetNX 和 EX 分开配置

一般来说我们上来就会说，Set的时候设置一个`NX`参数。保证只能创建一个锁。 这个时候如果接下来的线程阻塞了就会导致整个系统都阻塞，这是在业务面上比较危险的事情。非原子情况下使用`EX|PX`来保证redis锁到期后，会自动删除。

一般来说go-redis很少出现这种情况。go-redis 使用了SetNx会自动配置一个时间，如果不想设置时间就设置成-1，也就是说，写一个分两步的操作某种程度上也挺难的

```
